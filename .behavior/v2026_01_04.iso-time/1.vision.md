# vision: iso-time

## .goal

rename `uni-time` to `iso-time` with clearer terminology that distinguishes:
- **stamp** = absolute instant in history (anchored to a specific point in time)
- **float** = detached time pattern (unanchored, could refer to many instants)

etymology:
- `Stamp` — matches PostgreSQL `timestamp` semantics; a time "stamped" into history
- `Float` — a time that floats, not anchored; could land on many different instants

---

## .proposed domain objects

### stamps (absolute instants)

| type | format | example | semantics |
|------|--------|---------|-----------|
| `IsoTimeStamp` | `yyyy-MM-ddTHH:mm:ssZ` | `'2024-01-15T14:30:00Z'` | exact instant in history |
| `IsoDateStamp` | `yyyy-MM-dd` | `'2024-01-15'` | exact day in history |
| `IsoMonthStamp` | `yyyy-MM` | `'2024-01'` | exact month in history |
| `IsoYearStamp` | `yyyy` | `'2024'` | exact year in history |

### floats (detached patterns)

| type | format | example | semantics |
|------|--------|---------|-----------|
| `IsoTimeFloat` | `HH:mm:ss` | `'14:30:00'` | time of day (floats daily) |
| `IsoHourFloat` | `HH` | `'14'` | hour of day (floats daily) |
| `IsoMinuteFloat` | `mm` | `'30'` | minute of hour (floats hourly) |
| `IsoMonthFloat` | `MM` | `'01'` | month of year (floats yearly) |
| `IsoDayFloat` | `dd` | `'15'` | day of month (floats monthly) |
| `IsoWeekdayFloat` | `d` | `'1'` | day of week (floats weekly, 1=monday) |

> `Iso` prefix guarantees strict ISO 8601 format — no optional segments

---

## .realworld usage examples

### example 1: event schedule system

```ts
import {
  IsoTimeStamp, IsoDateStamp, IsoTimeFloat,
  IsoWeekdayFloat, IsoDuration
} from 'iso-time';

// when exactly the event occurs (absolute)
interface ScheduledEvent {
  createdAt: IsoTimeStamp;     // '2024-01-15T14:30:00Z'
  occursOn: IsoDateStamp;      // '2024-03-20'
}

// detached schedule pattern (float)
interface DailySchedule {
  since: IsoTimeFloat;         // '09:00:00' - every day at 9am
  until: IsoTimeFloat;         // '10:00:00'
}

// scheduled standup with date range and weekday pattern
interface ScheduledStandup {
  repeats: {
    since: IsoDateStamp;       // '2024-01-15' - start date
    until: IsoDateStamp;       // '2024-12-31' - end date
  };
  occurs: {
    days: IsoWeekdayFloat[];   // ['1', '3', '5'] - mon, wed, fri
    at: IsoTimeFloat;          // '09:00:00'
    for: IsoDuration;          // 'PT15M' - 15 minutes
  };
}
```

**verdict:** ✅ clear distinction between absolute event time vs float pattern

---

### example 2: invoice system

```ts
import { IsoMonthStamp, IsoDayFloat, IsoMonthFloat } from 'iso-time';

// bill period (absolute)
interface Invoice {
  period: IsoMonthStamp;  // '2024-01' - January 2024 invoice
}

// bill schedule (float)
interface BillSchedule {
  dueOn: IsoDayFloat;             // '15' - due on 15th of each month
  renewsOn: IsoMonthFloat;        // '01' - annual renewal in January
}
```

**verdict:** ✅ makes the absolute vs float distinction obvious

---

### example 3: timestamp manipulation

```ts
import { IsoTimeStamp, IsoDateStamp, addDuration, getDuration } from 'iso-time';

const eventStartedAt: IsoTimeStamp = '2024-01-15T14:30:00Z';
const eventEndedAt: IsoTimeStamp = addDuration(eventStartedAt, { hours: 2 });
// -> '2024-01-15T16:30:00Z'

const today: IsoDateStamp = '2024-01-15';
const nextWeek: IsoDateStamp = addDuration(today, { days: 7 });
// -> '2024-01-22'

const duration = getDuration({ since: eventStartedAt, until: eventEndedAt });
// -> { hours: 2 }
```

**verdict:** ✅ operations look clean

---

### example 4: date ranges

```ts
import { IsoTimeStampRange, IsoDateStampRange } from 'iso-time';

const appointmentWindow: IsoDateStampRange = {
  since: '2024-01-15',  // inclusive
  until: '2024-01-22',  // exclusive
};

const sessionDuration: IsoTimeStampRange = {
  since: '2024-01-15T14:30:00Z',
  until: '2024-01-15T16:30:00Z',
};
```

**verdict:** ✅ clear name pattern

---

### example 5: store hours config

```ts
import { IsoTimeFloat, IsoDayFloat } from 'iso-time';

interface StoreHours {
  open: {
    since: IsoTimeFloat;     // '09:00:00'
    until: IsoTimeFloat;     // '21:00:00'
  };
}

interface PaymentDueConfig {
  dayOfMonth: IsoDayFloat;   // '01' - due on 1st of month
}
```

**verdict:** ✅ float patterns are intuitive

---

## .pros

1. **`Iso` prefix is universal** — ISO 8601 is globally recognized; signals format immediately

2. **`stamp` vs `float` is semantically precise**
   - stamp = absolute, singular, historical moment
   - float = detached, unanchored, schedule-like pattern

3. **self-evident names** — `IsoTimeStamp` vs `IsoTimeFloat` immediately communicates precision AND nature

4. **consistent name pattern** — all types follow `Iso{Unit}{Nature}` structure

5. **fewer conflicts** — `IsoTimeStamp` won't clash with other libs like `UniDateTime` might

---

## .cons

1. ~~**`Onwall` is novel jargon**~~ **RESOLVED → `Float`**
   - ~~not a standard term; will require explanation~~
   - **decision: use `Float`** — conveys detached, unanchored time

2. **`DateStamp` is awkward**
   - "datestamp" isn't a real word (unlike "timestamp")
   - `IsoDateStamp` feels forced
   - alternatives: `IsoDate`, `IsoDayStamp`, `IsoDateMark`?

3. ~~**case inconsistency potential**~~ **RESOLVED**
   - ~~is it `IsoMonthstamp` or `IsoMonthStamp`?~~
   - **decision: all camelCase `Stamp` suffix** (e.g., `IsoMonthStamp`)

4. ~~**alias proliferation**~~ **RESOLVED**
   - ~~wish proposes 3 aliases for IsoTimeStamp: `IsoStampTime`, `IsoTimeStamp`, `IsoTimestamp`~~
   - ~~too many aliases → confusion about canonical name~~
   - **decision:** one canonical name per type — `Iso{Unit}{Nature}` pattern (e.g., `IsoTimeStamp`, `IsoTimeFloat`)

---

## .awkward discoveries

### ~~awkward 1: `IsoYearFloat` makes no sense~~ **RESOLVED**

~~a year that repeats? years don't cycle in a meaningful way.~~
- ~~fiscal year alignment? (april-march vs jan-dec) → not really a year pattern~~
- ~~leap year cycle? → too niche~~

**decision:** drop `IsoYearFloat` — years don't cycle in a meaningful way

### ~~awkward 2: `IsoDayFloat` vs `IsoWeekdayFloat`~~ **RESOLVED**

```ts
// day of month (repeats monthly)
const paymentDue: IsoDayFloat = '15';  // 15th of each month

// day of week (repeats weekly)
const standupDay: IsoWeekdayFloat = '1';  // monday (1-7)
```

~~the wish doesn't mention weekday patterns, but they're common. do we need both?~~

**decision:** add both — they serve different use cases:
- `IsoDayFloat` = day of month (dd, 01-31)
- `IsoWeekdayFloat` = day of week (d, 1-7, monday=1)

### ~~awkward 3: what precision for `IsoTimeFloat`?~~ **RESOLVED**

~~should seconds/milliseconds be allowed?~~

**decision:** `Iso` prefix means strict format — no optional segments:
```ts
const standup: IsoTimeFloat = '09:00:00';   // HH:mm:ss (strict)
const nineAM: IsoHourFloat = '09';          // HH (strict)
const halfPast: IsoMinuteFloat = '30';      // mm (strict)
```

each precision level gets its own type — no ambiguity

### ~~awkward 4: alias confusion~~ **RESOLVED**

~~the wish proposes:~~
- ~~`IsoTimeStamp` (canonical)~~
- ~~`IsoStampTime` (alias)~~
- ~~`IsoTimestamp` (alias)~~

~~this creates confusion:~~
- ~~which one should I use?~~
- ~~are they truly identical?~~
- ~~which shows up in autocomplete?~~

**decision:** one canonical name per type, ZERO aliases — `Iso{Unit}{Nature}` pattern only

### ~~awkward 5: `stamp` terminology for dates~~ **RESOLVED**

~~"timestamp" is universally understood. but:~~
- ~~"datestamp" → not a real word~~
- ~~"monthstamp" → even more awkward~~
- ~~"yearstamp" → ditto~~

~~alternatives considered:~~
| ~~proposal~~ | ~~alternative~~ |
|----------|-------------|
| ~~`IsoDateStamp`~~ | ~~`IsoDateMark`, `IsoDay`~~ |
| ~~`IsoMonthStamp`~~ | ~~`IsoMonth`, `IsoMonthMark`~~ |
| ~~`IsoYearStamp`~~ | ~~`IsoYear`, `IsoYearMark`~~ |

**decision:** keep `Stamp` suffix for all — PostgreSQL established `timestamp`, so `DateStamp`, `MonthStamp`, `YearStamp` follow naturally

---

## .decision checklist

before implementation, resolve:

- [x] **aliases**: ~~keep or drop?~~ → **drop all aliases; one canonical name per type**
- [x] **case**: ~~`IsoMonthstamp` or `IsoMonthStamp`?~~ → **`IsoMonthStamp` (camelCase)**
- [x] **stamp suffix**: ~~extend to all units or only timestamp?~~ → **all units use `Stamp`**
- [x] **float term**: ~~keep `Onwall` or find alternative?~~ → **use `Float`**
- [x] **weekday pattern**: ~~include `IsoWeekdayFloat`?~~ → **yes, add `IsoWeekdayFloat` (d, 1-7)**
- [x] **year float**: ~~confirm to drop `IsoYearFloat`~~ → **drop it; years don't cycle**
- [x] **time precision**: ~~`HH:mm` only or allow `HH:mm:ss`?~~ → **strict: `IsoTimeFloat`=`HH:mm:ss`, add `IsoHourFloat`, `IsoMinuteFloat`**
- [x] **range terms**: use `since`/`until` for time range boundaries

---

## .summary

the core insight is solid:
- **stamp** = absolute moment in history (anchored)
- **float** = detached pattern (unanchored, could land on many instants)

~~the awkward parts:~~ **ALL RESOLVED**
1. ~~"DateStamp/MonthStamp/YearStamp" aren't natural words~~ → **resolved: follows PostgreSQL `timestamp` precedent**
2. ~~"onwall" requires explanation~~ → **resolved: use `Float`**
3. ~~too many aliases proposed~~ → **resolved: one canonical name per type, ZERO aliases**
4. ~~`IsoYearFloat` doesn't make sense~~ → **resolved: dropped**

**final decisions:**
1. ~~drop all aliases~~ → **decided: one canonical name per type**
2. ~~consider `IsoDatePoint` pattern instead of `IsoDateStamp`~~ → **decided: use `Stamp` for all**
3. ~~drop `IsoYearFloat`~~ → **decided: dropped**
4. ~~add `IsoWeekdayFloat`~~ → **decided: added (d, 1-7, monday=1)**
5. ~~pick case rule~~ → **decided: all camelCase `Stamp` suffix (e.g., `IsoMonthStamp`)**
6. ~~pick float term~~ → **decided: use `Float` (e.g., `IsoTimeFloat`)**
7. ~~range boundary terms~~ → **decided: use `since`/`until`**
