# execution: iso-time implementation

tracking progress through the roadmap phases.

---

## status legend

- `[ ]` = pending
- `[~]` = in progress
- `[x]` = complete
- `[!]` = blocked

---

## milestone 1: domain objects ✅

### 1.1 stamp types

- [x] create `src/domain.objects/IsoTimeStamp.ts`
- [x] create `src/domain.objects/IsoTimeStamp.test.ts`

### 1.2 float types

- [x] create `src/domain.objects/IsoTimeFloat.ts`
- [x] create `src/domain.objects/IsoTimeFloat.test.ts`

### 1.3 range types

- [x] create `src/domain.objects/IsoTimeStampRange.ts`
- [x] create `src/domain.objects/IsoTimeStampRange.test.ts`

### 1.4 duration type

- [x] create `src/domain.objects/IsoDuration.ts`
- [x] create `src/domain.objects/IsoDuration.test.ts`

### 1.5 milestone verification

- [x] verify milestone 1 complete (27 tests passed)

---

## milestone 2: checks — stamp validators ✅

### 2.1 IsoTimeStamp validator

- [x] create `src/domain.operations/checks/isIsoTimeStamp.ts`
- [x] create `src/domain.operations/checks/isIsoTimeStamp.test.ts`

### 2.2 IsoDateStamp validator

- [x] create `src/domain.operations/checks/isIsoDateStamp.ts`
- [x] create `src/domain.operations/checks/isIsoDateStamp.test.ts`

### 2.3 IsoMonthStamp validator

- [x] create `src/domain.operations/checks/isIsoMonthStamp.ts`
- [x] create `src/domain.operations/checks/isIsoMonthStamp.test.ts`

### 2.4 IsoYearStamp validator

- [x] create `src/domain.operations/checks/isIsoYearStamp.ts`
- [x] create `src/domain.operations/checks/isIsoYearStamp.test.ts`

### 2.5 milestone verification

- [x] verify milestone 2 complete (57 tests pass)

---

## milestone 3: checks — float validators ✅

### 3.1-3.6 float validators

- [x] create `src/domain.operations/checks/isIsoTimeFloat.ts`
- [x] create `src/domain.operations/checks/isIsoTimeFloat.test.ts`
- [x] create `src/domain.operations/checks/isIsoHourFloat.ts`
- [x] create `src/domain.operations/checks/isIsoHourFloat.test.ts`
- [x] create `src/domain.operations/checks/isIsoMinuteFloat.ts`
- [x] create `src/domain.operations/checks/isIsoMinuteFloat.test.ts`
- [x] create `src/domain.operations/checks/isIsoMonthFloat.ts`
- [x] create `src/domain.operations/checks/isIsoMonthFloat.test.ts`
- [x] create `src/domain.operations/checks/isIsoDayFloat.ts`
- [x] create `src/domain.operations/checks/isIsoDayFloat.test.ts`
- [x] create `src/domain.operations/checks/isIsoWeekdayFloat.ts`
- [x] create `src/domain.operations/checks/isIsoWeekdayFloat.test.ts`

### 3.7 milestone verification

- [x] verify milestone 3 complete (59 tests pass)

---

## milestone 4: checks — range validators ✅

- [x] create `src/domain.operations/checks/isIsoTimeStampRange.ts`
- [x] create `src/domain.operations/checks/isIsoTimeStampRange.test.ts`
- [x] create `src/domain.operations/checks/isIsoDateStampRange.ts`
- [x] create `src/domain.operations/checks/isIsoDateStampRange.test.ts`
- [x] verify milestone 4 complete (26 tests pass)

---

## milestone 5: manipulate operations ✅

- [x] update `src/domain.operations/manipulate/addDuration.ts`
- [x] update `src/domain.operations/manipulate/addDuration.test.ts`
- [x] update `src/domain.operations/manipulate/subDuration.ts`
- [x] update `src/domain.operations/manipulate/subDuration.test.ts`
- [x] update `src/domain.operations/manipulate/getDuration.ts`
- [x] update `src/domain.operations/manipulate/getDuration.test.ts`
- [x] update `src/domain.operations/manipulate/toMilliseconds.ts`
- [x] update `src/domain.operations/manipulate/toMilliseconds.test.ts`
- [x] verify milestone 5 complete (26 tests pass)

---

## milestone 6: observe operations ✅

- [x] create `src/domain.operations/observe/now.ts`
- [x] create `src/domain.operations/observe/now.test.ts`
- [x] create `src/domain.operations/observe/today.ts`
- [x] create `src/domain.operations/observe/today.test.ts`
- [x] update stopwatch with new types
- [x] update sleep.ts to use IsoDuration
- [x] update waitFor.ts to use IsoDuration
- [x] verify milestone 6 complete (7 tests pass)

---

## milestone 7: casts and exports ✅

- [x] update `src/domain.operations/casts/toMillisecondsSinceEpoch.ts` (already uses Iso* types)
- [x] update `src/index.ts` (added all Iso* exports, kept Uni* for backwards compat)
- [x] verify milestone 7 complete (build and 203 tests pass)

---

## milestone 8: integration tests ✅

- [x] create/verify cast integration tests (toMillisecondsSinceEpoch.integration.test.ts)
- [x] create/verify addDuration integration tests (addDuration.integration.test.ts)
- [x] create/verify stopwatch integration tests (startDurationStopwatch.integration.test.ts)
- [x] verify milestone 8 complete (16 integration tests pass)

---

## milestone 9: acceptance tests ✅

- [x] create `src/iso-time.acceptance.test.ts` (public API verification)
- [x] verify milestone 9 complete (19 acceptance tests pass)

---

## milestone 10: cleanup and finalization ✅

- [x] cleanup old uni-time references (kept for backwards compat)
- [x] add backwards compatibility exports (Uni* types remain in index.ts)
- [x] run full test suite (203 unit + 16 integration + 19 acceptance = 238 tests)
- [x] verify production build (tsc compiles successfully)
- [x] verify milestone 10 complete

---

## final verification

- [x] all milestones complete

---

## execution log

### session 1 — 2026-01-05

starting execution from milestone 1...

**milestone 1 complete**
- created IsoTimeStamp.ts (4 types: IsoTimeStamp, IsoDateStamp, IsoMonthStamp, IsoYearStamp)
- created IsoTimeFloat.ts (6 types: IsoTimeFloat, IsoHourFloat, IsoMinuteFloat, IsoMonthFloat, IsoDayFloat, IsoWeekdayFloat)
- created IsoTimeStampRange.ts (2 types: IsoTimeStampRange, IsoDateStampRange)
- created IsoDuration.ts (added years and months fields)
- all 27 type tests pass
- type composition verified (IsoTimeStamp → IsoDateStamp, IsoTimeStampRange → IsoDateStampRange)

**milestone 2 complete**
- created isIsoTimeStamp.ts with asIsoTimeStamp cast function
- created isIsoDateStamp.ts with asIsoDateStamp cast function
- created isIsoMonthStamp.ts with asIsoMonthStamp cast function
- created isIsoYearStamp.ts with asIsoYearStamp cast function
- all validators use withAssure pattern for type guards
- 57 tests pass

**milestone 3 complete**
- created isIsoTimeFloat.ts (HH:mm:ss format, semantic range validation)
- created isIsoHourFloat.ts (HH format, 00-23)
- created isIsoMinuteFloat.ts (mm format, 00-59)
- created isIsoMonthFloat.ts (MM format, 01-12)
- created isIsoDayFloat.ts (dd format, 01-31)
- created isIsoWeekdayFloat.ts (d format, 1-7)
- 59 tests pass

**milestone 4 complete**
- created isIsoTimeStampRange.ts (validates { since, until } with IsoTimeStamp)
- created isIsoDateStampRange.ts (validates { since, until } with IsoDateStamp)
- 26 tests pass

**milestone 5 complete**
- updated toMilliseconds.ts with years/months support (DAYS_PER_YEAR=365.25, DAYS_PER_MONTH=30.44)
- updated addDuration.ts to use Iso* types with function overloads
- updated subDuration.ts to use Iso* types with function overloads
- updated getDuration.ts to use Iso* types and IsoTimeStampRange/IsoDateStampRange
- updated toMillisecondsSinceEpoch.ts to use Iso* types
- 26 tests pass

**milestone 6 complete**
- created now.ts returning IsoTimeStamp (UTC, yyyy-MM-dd'T'HH:mm:ss'Z')
- created today.ts returning IsoDateStamp (UTC, yyyy-MM-dd)
- updated stopwatch to use IsoDuration
- updated sleep.ts to use IsoDuration
- updated waitFor.ts to use IsoDuration
- fixed type errors in getDuration.ts (Object.fromEntries cast)
- 7 tests pass

**session summary**
- milestones 1-6 complete
- 203 total unit tests pass
- type tests pass
- format/lint pass
- build compiles successfully

proceeding to milestone 7 (casts and exports)...

### session 2 — 2026-01-05

continuing from milestone 7...

**milestone 7 complete**
- updated `src/index.ts` with all Iso* exports
- kept Uni* types for backwards compatibility
- build compiles successfully

**milestone 8 complete**
- created `addDuration.integration.test.ts` (6 tests)
- created `toMillisecondsSinceEpoch.integration.test.ts` (6 tests)
- created `startDurationStopwatch.integration.test.ts` (4 tests)
- 16 integration tests pass

**milestone 9 complete**
- created `iso-time.acceptance.test.ts` (public API verification)
- covers stamps, floats, ranges, durations, observe ops, casts, utils
- 19 acceptance tests pass

**milestone 10 complete**
- fixed type errors in test files (branded types require `as*` cast functions)
- fixed formatting issues
- all 238 tests pass (203 unit + 16 integration + 19 acceptance)
- production build verified

**final summary**
- all 10 milestones complete
- Iso* types fully implemented with proper branded types
- backwards compatibility preserved via Uni* exports
- comprehensive test coverage at all levels
